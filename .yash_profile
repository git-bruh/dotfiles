#!/bin/sh

. /etc/profile

# TTY
export TERM="${TERM:=linux}"

# General config

export PATH="$HOME/.local/bin:$PATH:$HOME/.local/share/flatpak/exports/bin"
export PATH="$HOME/.rustup/toolchains/stable-x86_64-unknown-linux-musl/bin:$PATH:$HOME/.cargo/bin"

export EDITOR=vi
export LANG=en_US.UTF-8

export MOZ_WEBRENDER=1
export MOZ_ENABLE_WAYLAND=1
export SDL_VIDEODRIVER=wayland

export GTK_THEME=Catppuccin-Mocha

# Build config

export CC=/usr/lib/icecc/bin/clang
export CXX=/usr/lib/icecc/bin/clang++
export CFLAGS="-O2 -pipe -march=x86-64-v3 -fstack-protector-strong --param ssp-buffer-size=4"
export CXXFLAGS="$CFLAGS"
export MAKEFLAGS="-j17"
export SAMUFLAGS="$MAKEFLAGS"

# KISS config

export ICECC_VERSION=aarch64:/opt/icecc-envs/aarch64/cb7a5638137df913717cf468037bab41.tar.gz,x86_64:/opt/icecc-envs/native/663758560241425456b899031f6be952.tar.gz
export KISS_SANDBOX_FILES="/var/run/icecc/iceccd.socket /opt/icecc-envs"

export KISS_PATH=

KISS_PATH="$KISS_PATH:$HOME/KISS/kiss-repo/overrides"
KISS_PATH="$KISS_PATH:$HOME/KISS/repo/core"
KISS_PATH="$KISS_PATH:$HOME/KISS/repo/extra"
KISS_PATH="$KISS_PATH:$HOME/KISS/repo/wayland"
KISS_PATH="$KISS_PATH:$HOME/KISS/kiss-repo/repo"
KISS_PATH="$KISS_PATH:$HOME/KISS/kiss-dbus/dbus"
KISS_PATH="$KISS_PATH:$HOME/KISS/community/community"

# Sway auto-start

if [ "$(tty)" = "/dev/tty1" ]; then
    export XDG_CURRENT_DESKTOP=sway
    exec dbus-run-session sway --unsupported-gpu
fi
